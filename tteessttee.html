<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENEM Bíblico - Inscrições</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #1a4b8c;
            --secondary-color: #f8c300;
            --light-color: #f5f5f5;
            --dark-color: #333;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --step-color: #e9ecef;
            --step-active: #1a4b8c;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        .container {
            width: 90%;
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 0;
        }
        
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 2rem 0;
            position: relative;
        }
        
        .step-indicator::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 0;
            right: 0;
            height: 4px;
            background-color: var(--step-color);
            z-index: 1;
        }
        
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .step-number {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: var(--step-color);
            color: var(--dark-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 0.5rem;
            transition: all 0.3s;
        }
        
        .step.active .step-number {
            background-color: var(--step-active);
            color: white;
        }
        
        .step-label {
            font-size: 0.85rem;
            text-align: center;
        }
        
        .form-container {
            background-color: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .form-section {
            display: none;
        }
        
        .form-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .form-title {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--light-color);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-row {
            display: flex;
            gap: 1rem;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .required::after {
            content: ' *';
            color: var(--danger-color);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(26, 75, 140, 0.2);
        }
        
        input.error, select.error, textarea.error {
            border-color: var(--danger-color);
        }
        
        .error-message {
            color: var(--danger-color);
            font-size: 0.85rem;
            margin-top: 0.25rem;
            display: none;
        }
        
        .radio-group {
            display: flex;
            gap: 1.5rem;
            margin-top: 0.5rem;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .radio-option input {
            width: auto;
        }
        
        .summary-section {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .summary-item {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .summary-label {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.25rem;
        }
        
        .confirmation-section {
            text-align: center;
            padding: 2rem;
        }
        
        .confirmation-icon {
            font-size: 4rem;
            color: var(--success-color);
            margin-bottom: 1rem;
        }
        
        .registration-number {
            background-color: #e9ecef;
            padding: 1rem;
            border-radius: 5px;
            font-family: monospace;
            font-size: 1.2rem;
            margin: 1.5rem 0;
            display: inline-block;
        }
        
        .form-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }
        
        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #153a6e;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 0.5rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .progress-bar {
            height: 5px;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
            margin-bottom: 1rem;
        }
        
        .field-hint {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 5px;
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .notification.success {
            background-color: var(--success-color);
        }
        
        .notification.error {
            background-color: var(--danger-color);
        }
        
        .notification.warning {
            background-color: var(--warning-color);
            color: var(--dark-color);
        }
        
        .auto-save-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }
        
        .auto-save-indicator.show {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .step-label {
                font-size: 0.75rem;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .notification {
                left: 20px;
                right: 20px;
            }
            
            .auto-save-indicator {
                bottom: 10px;
                right: 10px;
                left: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>ENEM Bíblico</h1>
            <p>Teste seus conhecimentos da Palavra de Deus</p>
        </div>
    </header>

    <main class="container">
        <div class="progress-bar" id="progress-bar"></div>
        
        <div class="step-indicator">
            <div class="step active" data-step="1">
                <div class="step-number">1</div>
                <div class="step-label">Dados Pessoais</div>
            </div>
            <div class="step" data-step="2">
                <div class="step-number">2</div>
                <div class="step-label">Perfil Bíblico</div>
            </div>
            <div class="step" data-step="3">
                <div class="step-number">3</div>
                <div class="step-label">Modalidade</div>
            </div>
            <div class="step" data-step="4">
                <div class="step-number">4</div>
                <div class="step-label">Confirmação</div>
            </div>
            <div class="step" data-step="5">
                <div class="step-number">5</div>
                <div class="step-label">Finalização</div>
            </div>
        </div>

        <div class="form-container">
            <!-- Seção 1: Dados Pessoais -->
            <div class="form-section active" id="section-1">
                <h2 class="form-title">Dados Pessoais</h2>
                
                <div class="form-group">
                    <label for="name" class="required">Nome Completo</label>
                    <input type="text" id="name" name="name" required aria-describedby="name-hint">
                    <div class="field-hint" id="name-hint">Informe seu nome completo como consta em documentos oficiais</div>
                    <div class="error-message" id="name-error">Por favor, informe seu nome completo</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="phone" class="required">Telefone</label>
                        <input type="tel" id="phone" name="phone" required placeholder="(00) 00000-0000">
                        <div class="error-message" id="phone-error">Por favor, informe um telefone válido</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="age" class="required">Idade</label>
                        <input type="number" id="age" name="age" min="1" max="120" required>
                        <div class="error-message" id="age-error">Por favor, informe sua idade (entre 1 e 120 anos)</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="gender" class="required">Gênero</label>
                    <select id="gender" name="gender" required>
                        <option value="">Selecione</option>
                        <option value="Masculino">Masculino</option>
                        <option value="Feminino">Feminino</option>
                        <option value="Outro">Outro</option>
                    </select>
                    <div class="error-message" id="gender-error">Por favor, selecione seu gênero</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="state" class="required">Estado</label>
                        <select id="state" name="state" required>
                            <option value="">Selecione</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                        <div class="error-message" id="state-error">Por favor, selecione seu estado</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="city" class="required">Cidade</label>
                        <input type="text" id="city" name="city" required>
                        <div class="error-message" id="city-error">Por favor, informe sua cidade</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="address" class="required">Endereço</label>
                    <input type="text" id="address" name="address" required>
                    <div class="error-message" id="address-error">Por favor, informe seu endereço</div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="neighborhood" class="required">Bairro</label>
                        <input type="text" id="neighborhood" name="neighborhood" required>
                        <div class="error-message" id="neighborhood-error">Por favor, informe seu bairro</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="houseNumber" class="required">Número</label>
                        <input type="text" id="houseNumber" name="houseNumber" required>
                        <div class="error-message" id="houseNumber-error">Por favor, informe o número</div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="denomination" class="required">Denominação (Igreja)</label>
                    <input type="text" id="denomination" name="denomination" required>
                    <div class="error-message" id="denomination-error">Por favor, informe sua denominação</div>
                </div>
                
                <div class="form-navigation">
                    <div></div>
                    <button type="button" class="btn btn-primary" id="next-1">Próximo</button>
                </div>
            </div>
            
            <!-- Seção 2: Perfil Bíblico -->
            <div class="form-section" id="section-2">
                <h2 class="form-title">Perfil Bíblico</h2>
                
                <div class="form-group">
                    <label for="bibleStudyTime">Quanto tempo estuda a Bíblia?</label>
                    <select id="bibleStudyTime" name="bibleStudyTime">
                        <option value="">Selecione</option>
                        <option value="Menos de 1 ano">Menos de 1 ano</option>
                        <option value="1-3 anos">1-3 anos</option>
                        <option value="3-5 anos">3-5 anos</option>
                        <option value="5-10 anos">5-10 anos</option>
                        <option value="Mais de 10 anos">Mais de 10 anos</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="ministry">Frequenta qual ministério?</label>
                    <input type="text" id="ministry" name="ministry" placeholder="Ex: Louvor, Jovens, Crianças...">
                </div>
                
                <div class="form-group">
                    <label>Participa da escola bíblica?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="attendsSundaySchool-yes" name="attendsSundaySchool" value="Sim">
                            <label for="attendsSundaySchool-yes">Sim</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="attendsSundaySchool-no" name="attendsSundaySchool" value="Não">
                            <label for="attendsSundaySchool-no">Não</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Já fez algum curso bíblico?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="hasBiblicalCourse-yes" name="hasBiblicalCourse" value="Sim">
                            <label for="hasBiblicalCourse-yes">Sim</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="hasBiblicalCourse-no" name="hasBiblicalCourse" value="Não">
                            <label for="hasBiblicalCourse-no">Não</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-navigation">
                    <button type="button" class="btn btn-secondary" id="prev-2">Voltar</button>
                    <button type="button" class="btn btn-primary" id="next-2">Próximo</button>
                </div>
            </div>
            
            <!-- Seção 3: Modalidade da Prova -->
            <div class="form-section" id="section-3">
                <h2 class="form-title">Modalidade da Prova</h2>
                
                <div class="form-group">
                    <label class="required">Selecione a modalidade:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="examModal-children" name="examModal" value="Crianças" required>
                            <label for="examModal-children">Crianças (até 12 anos)</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="examModal-youth" name="examModal" value="Jovens" required>
                            <label for="examModal-youth">Jovens (13-17 anos)</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="examModal-adults" name="examModal" value="Adultos" required>
                            <label for="examModal-adults">Adultos (18+ anos)</label>
                        </div>
                    </div>
                    <div class="error-message" id="examModal-error">Por favor, selecione uma modalidade</div>
                </div>
                
                <div class="form-group">
                    <label for="observations">Observações (opcional)</label>
                    <textarea id="observations" name="observations" rows="4" placeholder="Alguma observação adicional..."></textarea>
                </div>
                
                <div class="form-navigation">
                    <button type="button" class="btn btn-secondary" id="prev-3">Voltar</button>
                    <button type="button" class="btn btn-primary" id="next-3">Próximo</button>
                </div>
            </div>
            
            <!-- Seção 4: Revisão e Confirmação -->
            <div class="form-section" id="section-4">
                <h2 class="form-title">Revisão e Confirmação</h2>
                
                <div class="summary-section" id="summary-content">
                    <!-- O resumo será preenchido dinamicamente -->
                </div>
                
                <div class="form-navigation">
                    <button type="button" class="btn btn-secondary" id="prev-4">Voltar e Editar</button>
                    <button type="button" class="btn btn-success" id="confirm-registration">Confirmar Inscrição</button>
                </div>
            </div>
            
            <!-- Seção 5: Finalização -->
            <div class="form-section" id="section-5">
                <div class="confirmation-section">
                    <div class="confirmation-icon">✓</div>
                    <h2 class="form-title">Inscrição realizada com sucesso!</h2>
                    <p>Sua inscrição no ENEM Bíblico foi confirmada. Abaixo está o seu número de inscrição:</p>
                    <div class="registration-number" id="registration-number-display"></div>
                    <p>Guarde este número para futuras consultas.</p>
                    
                    <div class="form-navigation" style="justify-content: center; margin-top: 2rem;">
                        <button type="button" class="btn btn-secondary" id="new-registration">Nova Inscrição</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="notification" id="notification"></div>
    <div class="auto-save-indicator" id="auto-save-indicator">Dados salvos automaticamente</div>

    <script>
        // Variáveis globais
        let currentSection = 1;
        let registrationData = {};
        let registrationNumber = '';
        let autoSaveTimeout = null;

        // Elementos DOM
        const stepIndicators = document.querySelectorAll('.step');
        const formSections = document.querySelectorAll('.form-section');
        const summaryContent = document.getElementById('summary-content');
        const registrationNumberDisplay = document.getElementById('registration-number-display');
        const progressBar = document.getElementById('progress-bar');
        const notification = document.getElementById('notification');
        const autoSaveIndicator = document.getElementById('auto-save-indicator');

        // Chaves para localStorage
        const STORAGE_KEYS = {
            FORM_DATA: 'enem_biblico_form_data',
            CURRENT_SECTION: 'enem_biblico_current_section',
            REGISTRATION_COMPLETE: 'enem_biblico_registration_complete'
        };

        // FUNÇÃO CORRIGIDA PARA ENVIAR AO GOOGLE SHEETS
        async function submitToGoogleSheets() {
            // SUA URL DO GOOGLE APPS SCRIPT AQUI ↓
            const URL = 'https://script.google.com/macros/s/AKfycbwUp174sDiFtn-NNXVFiC8KH3BlOyjt3XizKoQSeF_1rQSaibiia3pc1gDux9ISWNm-/exec';
            
            try {
                // Gerar número de inscrição
                const registrationNumber = generateRegistrationNumber();
                
                // Adicionar número aos dados
                const dataToSend = {
                    ...registrationData,
                    registrationNumber: registrationNumber
                };
                
                const response = await fetch(URL, {
                    method: 'POST',
                    body: JSON.stringify(dataToSend)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Atualizar o número global para mostrar ao usuário
                    registrationNumber = dataToSend.registrationNumber;
                    return true;
                } else {
                    console.error('Erro no servidor:', result.error);
                    return false;
                }
                
            } catch (error) {
                console.log('Erro ao enviar:', error);
                return false;
            }
        }

        // Função para salvar dados no localStorage
        function saveFormData() {
            const formData = {
                registrationData: registrationData,
                currentSection: currentSection
            };
            localStorage.setItem(STORAGE_KEYS.FORM_DATA, JSON.stringify(formData));
            
            // Mostrar indicador de salvamento
            showAutoSaveIndicator();
        }

        // Função para carregar dados do localStorage
        function loadFormData() {
            const savedData = localStorage.getItem(STORAGE_KEYS.FORM_DATA);
            const registrationComplete = localStorage.getItem(STORAGE_KEYS.REGISTRATION_COMPLETE);
            
            // Se a inscrição já foi completada, não carregar dados antigos
            if (registrationComplete === 'true') {
                clearFormData();
                return;
            }
            
            if (savedData) {
                try {
                    const formData = JSON.parse(savedData);
                    registrationData = formData.registrationData || {};
                    currentSection = formData.currentSection || 1;
                    
                    // Preencher os campos do formulário com os dados salvos
                    populateFormFields();
                    
                    // Navegar para a seção salva
                    navigateToSection(currentSection, true);
                    
                    showNotification('Dados recuperados automaticamente. Você pode continuar de onde parou.', 'success');
                } catch (error) {
                    console.error('Erro ao carregar dados salvos:', error);
                    clearFormData();
                }
            }
        }

        // Função para preencher os campos do formulário com dados salvos
        function populateFormFields() {
            // Preencher campos de texto, select e textarea
            document.querySelectorAll('input, select, textarea').forEach(field => {
                if (field.type === 'radio') {
                    if (registrationData[field.name] === field.value) {
                        field.checked = true;
                    }
                } else if (field.type === 'checkbox') {
                    field.checked = registrationData[field.name] === 'true';
                } else if (field.type !== 'button') {
                    field.value = registrationData[field.name] || '';
                }
            });
        }

        // Função para limpar dados salvos
        function clearFormData() {
            localStorage.removeItem(STORAGE_KEYS.FORM_DATA);
            localStorage.removeItem(STORAGE_KEYS.CURRENT_SECTION);
            localStorage.removeItem(STORAGE_KEYS.REGISTRATION_COMPLETE);
            registrationData = {};
            currentSection = 1;
        }

        // Função para marcar inscrição como completa
        function markRegistrationComplete() {
            localStorage.setItem(STORAGE_KEYS.REGISTRATION_COMPLETE, 'true');
            clearFormData();
        }

        // Função para mostrar indicador de salvamento automático
        function showAutoSaveIndicator() {
            autoSaveIndicator.classList.add('show');
            setTimeout(() => {
                autoSaveIndicator.classList.remove('show');
            }, 2000);
        }

        // Função para navegar entre seções
        function navigateToSection(sectionNumber, skipValidation = false) {
            // Validar seção atual antes de avançar (a menos que skipValidation seja true)
            if (sectionNumber > currentSection && !skipValidation && !validateCurrentSection()) {
                return;
            }
            
            // Atualizar indicador de etapas
            stepIndicators.forEach(step => {
                const stepNumber = parseInt(step.getAttribute('data-step'));
                step.classList.toggle('active', stepNumber === sectionNumber);
            });
            
            // Atualizar seções do formulário
            formSections.forEach(section => {
                section.classList.toggle('active', section.id === `section-${sectionNumber}`);
            });
            
            // Atualizar seção atual
            currentSection = sectionNumber;
            
            // Atualizar barra de progresso
            updateProgressBar();
            
            // Salvar estado atual
            saveFormData();
            
            // Se for a seção de resumo, atualizar o conteúdo
            if (sectionNumber === 4) {
                updateSummary();
            }
            
            // Se for a seção de finalização, gerar número de inscrição
            if (sectionNumber === 5) {
                generateRegistrationNumber();
                markRegistrationComplete();
            }
        }

        // Função para atualizar a barra de progresso
        function updateProgressBar() {
            const progress = ((currentSection - 1) / 4) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Função para validar a seção atual
        function validateCurrentSection() {
            const currentSectionElement = document.getElementById(`section-${currentSection}`);
            const requiredFields = currentSectionElement.querySelectorAll('[required]');
            let isValid = true;
            
            // Limpar mensagens de erro anteriores
            const errorMessages = currentSectionElement.querySelectorAll('.error-message');
            errorMessages.forEach(error => {
                error.style.display = 'none';
            });
            
            // Remover classes de erro anteriores
            const errorFields = currentSectionElement.querySelectorAll('.error');
            errorFields.forEach(field => {
                field.classList.remove('error');
            });
            
            // Validar cada campo obrigatório
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    const errorId = `${field.id}-error`;
                    const errorElement = document.getElementById(errorId);
                    if (errorElement) {
                        errorElement.style.display = 'block';
                    }
                    field.classList.add('error');
                    isValid = false;
                }
            });
            
            // Validação específica para campos de rádio
            if (currentSection === 3) {
                const radioGroup = document.querySelector('input[name="examModal"]:checked');
                if (!radioGroup) {
                    document.getElementById('examModal-error').style.display = 'block';
                    isValid = false;
                }
            }
            
            // Validações específicas para campos
            if (currentSection === 1) {
                // Validar telefone
                const phoneField = document.getElementById('phone');
                const phoneValue = phoneField.value.replace(/\D/g, '');
                if (phoneValue.length < 10 || phoneValue.length > 11) {
                    document.getElementById('phone-error').style.display = 'block';
                    phoneField.classList.add('error');
                    isValid = false;
                }
                
                // Validar idade
                const ageField = document.getElementById('age');
                const ageValue = parseInt(ageField.value);
                if (ageValue < 1 || ageValue > 120) {
                    document.getElementById('age-error').style.display = 'block';
                    ageField.classList.add('error');
                    isValid = false;
                }
            }
            
            return isValid;
        }

        // Função para atualizar o resumo
        function updateSummary() {
            // Coletar todos os dados do formulário
            registrationData = {};
            
            // Dados dos inputs
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                if (input.type === 'radio') {
                    if (input.checked) {
                        registrationData[input.name] = input.value;
                    }
                } else if (input.type !== 'button') {
                    registrationData[input.name] = input.value;
                }
            });
            
            // Gerar HTML do resumo
            let summaryHTML = '';
            
            // Dados Pessoais
            summaryHTML += `
                <div class="summary-item">
                    <div class="summary-label">Dados Pessoais</div>
                    <div class="summary-value">
                        <strong>Nome:</strong> ${registrationData.name || 'Não informado'}<br>
                        <strong>Telefone:</strong> ${registrationData.phone || 'Não informado'}<br>
                        <strong>Idade:</strong> ${registrationData.age || 'Não informado'}<br>
                        <strong>Gênero:</strong> ${registrationData.gender || 'Não informado'}<br>
                        <strong>Estado:</strong> ${registrationData.state || 'Não informado'}<br>
                        <strong>Cidade:</strong> ${registrationData.city || 'Não informado'}<br>
                        <strong>Endereço:</strong> ${registrationData.address || 'Não informado'}<br>
                        <strong>Bairro:</strong> ${registrationData.neighborhood || 'Não informado'}<br>
                        <strong>Número:</strong> ${registrationData.houseNumber || 'Não informado'}<br>
                        <strong>Denominação:</strong> ${registrationData.denomination || 'Não informado'}
                    </div>
                </div>
            `;
            
            // Perfil Bíblico
            summaryHTML += `
                <div class="summary-item">
                    <div class="summary-label">Perfil Bíblico</div>
                    <div class="summary-value">
                        <strong>Tempo de estudo:</strong> ${registrationData.bibleStudyTime || 'Não informado'}<br>
                        <strong>Ministério:</strong> ${registrationData.ministry || 'Não informado'}<br>
                        <strong>Escola bíblica:</strong> ${registrationData.attendsSundaySchool || 'Não informado'}<br>
                        <strong>Curso bíblico:</strong> ${registrationData.hasBiblicalCourse || 'Não informado'}
                    </div>
                </div>
            `;
            
            // Modalidade e Observações
            summaryHTML += `
                <div class="summary-item">
                    <div class="summary-label">Modalidade e Observações</div>
                    <div class="summary-value">
                        <strong>Modalidade:</strong> ${registrationData.examModal || 'Não informado'}<br>
                        <strong>Observações:</strong> ${registrationData.observations || 'Nenhuma'}
                    </div>
                </div>
            `;
            
            summaryContent.innerHTML = summaryHTML;
        }

        // Função para gerar número de inscrição
        function generateRegistrationNumber() {
            const now = new Date();
            const dateString = now.toISOString().slice(0, 10).replace(/-/g, '');
            const randomPart = Math.floor(100000 + Math.random() * 900000);
            return `ENEMBIBL-${dateString}-${randomPart}`;
        }

        // Função para mostrar notificação
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 5000);
        }

        // Função para aplicar máscara de telefone
        function applyPhoneMask() {
            const phoneInput = document.getElementById('phone');
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.length <= 10) {
                    value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
                } else {
                    value = value.replace(/(\d{2})(\d{5})(\d{0,4})/, '($1) $2-$3');
                }
                
                e.target.value = value;
                
                // Salvar dados automaticamente
                scheduleAutoSave();
            });
        }

        // Função para agendar salvamento automático
        function scheduleAutoSave() {
            if (autoSaveTimeout) {
                clearTimeout(autoSaveTimeout);
            }
            autoSaveTimeout = setTimeout(() => {
                updateRegistrationData();
                saveFormData();
            }, 1000);
        }

        // Função para atualizar dados de registro
        function updateRegistrationData() {
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                if (input.type === 'radio') {
                    if (input.checked) {
                        registrationData[input.name] = input.value;
                    }
                } else if (input.type !== 'button') {
                    registrationData[input.name] = input.value;
                }
            });
        }

        // Função para reiniciar o formulário
        function resetForm() {
            document.querySelectorAll('input, select, textarea').forEach(field => {
                if (field.type === 'radio' || field.type === 'checkbox') {
                    field.checked = false;
                } else {
                    field.value = '';
                }
            });
            
            currentSection = 1;
            registrationData = {};
            registrationNumber = '';
            
            clearFormData();
            navigateToSection(1);
            showNotification('Formulário reiniciado. Você pode iniciar uma nova inscrição.', 'success');
        }

        // Adicionar event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Carregar dados salvos
            loadFormData();
            
            // Aplicar máscara de telefone
            applyPhoneMask();
            
            // Atualizar barra de progresso inicial
            updateProgressBar();
            
            // Adicionar validação em tempo real para campos obrigatórios
            document.querySelectorAll('[required]').forEach(field => {
                field.addEventListener('blur', function() {
                    if (!this.value.trim()) {
                        this.classList.add('error');
                        const errorId = `${this.id}-error`;
                        const errorElement = document.getElementById(errorId);
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                    } else {
                        this.classList.remove('error');
                        const errorId = `${this.id}-error`;
                        const errorElement = document.getElementById(errorId);
                        if (errorElement) {
                            errorElement.style.display = 'none';
                        }
                    }
                });
            });
            
            // Adicionar event listeners para salvamento automático
            document.querySelectorAll('input, select, textarea').forEach(field => {
                if (field.type !== 'button') {
                    field.addEventListener('input', scheduleAutoSave);
                    field.addEventListener('change', scheduleAutoSave);
                }
            });
            
            // Navegação entre seções
            document.getElementById('next-1').addEventListener('click', function() {
                navigateToSection(2);
            });
            document.getElementById('next-2').addEventListener('click', function() {
                navigateToSection(3);
            });
            document.getElementById('next-3').addEventListener('click', function() {
                navigateToSection(4);
            });
            
            document.getElementById('prev-2').addEventListener('click', function() {
                navigateToSection(1);
            });
            document.getElementById('prev-3').addEventListener('click', function() {
                navigateToSection(2);
            });
            document.getElementById('prev-4').addEventListener('click', function() {
                navigateToSection(3);
            });

            // Event Listener para confirmação de inscrição
            document.getElementById('confirm-registration').addEventListener('click', async function() {
                const button = this;
                const originalText = button.textContent;
                
                // Mostrar spinner
                button.innerHTML = '<span class="spinner"></span>Enviando...';
                button.disabled = true;
                
                // Enviar para Google Sheets
                const success = await submitToGoogleSheets();
                
                if (success) {
                    // Navegar para seção de finalização
                    navigateToSection(5);
                    
                    showNotification('Inscrição realizada com sucesso!', 'success');
                } else {
                    showNotification('Erro ao enviar inscrição. Tente novamente ou entre em contato conosco.', 'error');
                    button.innerHTML = originalText;
                    button.disabled = false;
                }
            });

            // Event Listener para nova inscrição
            document.getElementById('new-registration').addEventListener('click', function() {
                resetForm();
            });
        });
    </script>
</body>
</html>